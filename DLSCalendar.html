<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GAS Client Example</title>
    <link rel="stylesheet"
             href="https://fonts.googleapis.com/css?family=Montserrat|fire-animation|Montserrat:200">
       <style>
         body {
           font-family: 'Montserrat';
           font-size: 24px;

         }
         .eventName {
           font-family: 'Montserrat';
           color: #1f3c90;

         }
         .time {
           font-family: 'Montserrat';
           color: #1f3c90;
           font-weight: 200;
	   width: 30%;
         }

         table, th, td {
           border: 10px solid white;
           border-collapse: collapse;
         }
         th, td {
          background-color: rgba(0, 0, 0, 0);
        }

       </style>
</head>
<body>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
<script>
    const endpoint = "https://script.google.com/macros/s/AKfycbyII9rQVL1zB3uNT-IZ0QUrc-YnyfsCovuJdr1-29ZgijYOlDDBb_EZLh4vFBLlmrDOig/exec";

    function zeroPadding(num, len){
	return ( Array(len).join('0') + num ).slice( -len );
}

    function createDateString(startDateObject, endDateObject){


        // Tag
        let dNum = zeroPadding(startDateObject.getDate(), 2);
        let dateString = dNum.toString();

        // Monat
        let monthNo = startDateObject.getMonth() + 1;
        let moNum = zeroPadding(monthNo, 2);
        let monthString = moNum.toString();

        // Stunde
        let hNumStart = zeroPadding(startDateObject.getHours(), 2);
        let startHourString = hNumStart.toString();

        let hNumEnd = zeroPadding(endDateObject.getHours(), 2);
        let endHourString = hNumEnd.toString();

        // Minute
        let miNumStart = zeroPadding(startDateObject.getMinutes(), 2);
        let startMinutesString = miNumStart.toString();

        let miNumEnd = zeroPadding(endDateObject.getMinutes(), 2);
        let endMinutesString = miNumEnd.toString();

        let fullString = dateString + '.' + monthString + '. ' + startHourString + ':' + startMinutesString + ' – ' + endHourString + ':' + endMinutesString;
        return fullString
    }

    function createTable(){
        $.ajax({
        type: 'GET',
        url: endpoint,
        dataType: 'json',
        success: out => {
            //console.log(out);
            out = out.slice(0, 12);
            let calendarHtml = '';

          //darHtml += '<h1>Agenda</h1>';
            calendarHtml += '<table width=100% style="border:none;" bgcolor="#0028a5">';
            calendarHtml += '<tr style="color:#ffffff"><th>Veranstaltung</th><th> Veranstaltungszeit </th></tr>';

            out.forEach( el => {
                // Durch "Date()" wird die ISO-Zeitstring in Zeit-Objekt umgewandelt. Die Basis der Zeit wird auch (UTC) -> (CET/CEST) geändert.
                // Es gibt weitere Methods wie getMonth, getDay, getDate, getHours, getMinutes usw., um die Zeitangabe besser darzustellen.
                let st = new Date(el.startTime);
                let ed = new Date(el.endTime);

                let timeString = createDateString(st, ed);

                if (el.eventTitle.indexOf('Gesamt') !== -1 ){
                    calendarHtml += '<tr bgcolor="#f96a58"><td>' + el.eventTitle + '</td>';
                    calendarHtml += '<td>' + timeString + '</td></tr>';
                } else {
                    calendarHtml += '<tr bgcolor="#f1f5ff"><td>' + el.eventTitle + '</td>';
                    calendarHtml += '<td>' + timeString + '</td></tr>';
                }

            })

            calendarHtml += '</table>';

            document.querySelector('#calendar').innerHTML = calendarHtml;

        }
        });
    }

    // Tabelle wird einmal am Tag (1mal in 86400000 ms) erneuert
    let intervalID = setInterval(createTable(), 3600000)

</script>
<div id="calendar" style="background:#f1f5ff"></div>
</body>
</html>
